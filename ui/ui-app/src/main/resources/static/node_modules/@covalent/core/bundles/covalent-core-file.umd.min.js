!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?t(exports,require("@angular/core"),require("@angular/cdk/coercion"),require("@angular/forms"),require("@covalent/core/common"),require("@angular/cdk/portal"),require("rxjs/Observable"),require("rxjs/Subject"),require("@angular/common"),require("@angular/material/icon"),require("@angular/material/button")):"function"==typeof define&&define.amd?define(["exports","@angular/core","@angular/cdk/coercion","@angular/forms","@covalent/core/common","@angular/cdk/portal","rxjs/Observable","rxjs/Subject","@angular/common","@angular/material/icon","@angular/material/button"],t):t((e.covalent=e.covalent||{},e.covalent.core=e.covalent.core||{},e.covalent.core.file={}),e.ng.core,e.ng.cdk.coercion,e.ng.forms,e.covalent.core.common,e.ng.cdk.portal,e.Rx,e.Rx,e.ng.common,e.ng.material.icon,e.ng.material.button)}(this,function(e,t,n,r,o,i,l,a,p,u,c){"use strict";var s=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])};function d(e,t){function n(){this.constructor=e}s(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}var f=function(){function e(e){this.model=e,this._multiple=!1,this.onFileSelect=new t.EventEmitter}return Object.defineProperty(e.prototype,"multiple",{set:function(e){this._multiple=n.coerceBooleanProperty(e)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"multipleBinding",{get:function(){return this._multiple?"":undefined},enumerable:!0,configurable:!0}),e.prototype.onChange=function(e){if(e.target instanceof HTMLInputElement){var t=e.target.files;if(t.length){var n=this._multiple&&t.length>1?t:t[0];this.model?this.model.update.emit(n):this.onFileSelect.emit(n)}}},e}();f.decorators=[{type:t.Directive,args:[{selector:"[tdFileSelect]"}]}],f.ctorParameters=function(){return[{type:r.NgModel,decorators:[{type:t.Optional},{type:t.Host}]}]},f.propDecorators={multiple:[{type:t.Input,args:["multiple"]}],onFileSelect:[{type:t.Output,args:["fileSelect"]}],multipleBinding:[{type:t.HostBinding,args:["attr.multiple"]}],onChange:[{type:t.HostListener,args:["change",["$event"]]}]};var m=function(){return function(){}}(),g=o.mixinDisabled(m),h=function(e){function r(n,r){var o=e.call(this)||this;return o._renderer=n,o._element=r,o._multiple=!1,o.onFileDrop=new t.EventEmitter,o}return d(r,e),Object.defineProperty(r.prototype,"multiple",{set:function(e){this._multiple=n.coerceBooleanProperty(e)},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"multipleBinding",{get:function(){return this._multiple?"":undefined},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"disabledBinding",{get:function(){return this.disabled?"":undefined},enumerable:!0,configurable:!0}),r.prototype.onDrop=function(e){if(!this.disabled){var t=e.dataTransfer.files;if(t.length){var n=this._multiple&&t.length>1?t:t[0];this.onFileDrop.emit(n)}}this._renderer.removeClass(this._element.nativeElement,"drop-zone"),this._stopEvent(e)},r.prototype.onDragOver=function(e){var t=e.dataTransfer;t.dropEffect=this._typeCheck(t.types),this.disabled||!this._multiple&&(t.items&&t.items.length>1||t.mozItemCount>1)?t.dropEffect="none":t.dropEffect="copy",this._stopEvent(e)},r.prototype.onDragEnter=function(e){this.disabled||this._renderer.addClass(this._element.nativeElement,"drop-zone"),this._stopEvent(e)},r.prototype.onDragLeave=function(e){this._renderer.removeClass(this._element.nativeElement,"drop-zone"),this._stopEvent(e)},r.prototype._typeCheck=function(e){var t="none";return e&&(e.contains&&e.contains("Files")||e.indexOf&&-1!==e.indexOf("Files"))&&(t="copy"),t},r.prototype._stopEvent=function(e){e.preventDefault(),e.stopPropagation()},r}(g);h.decorators=[{type:t.Directive,args:[{selector:"[tdFileDrop]",inputs:["disabled"]}]}],h.ctorParameters=function(){return[{type:t.Renderer2},{type:t.ElementRef}]},h.propDecorators={multiple:[{type:t.Input,args:["multiple"]}],onFileDrop:[{type:t.Output,args:["fileDrop"]}],multipleBinding:[{type:t.HostBinding,args:["attr.multiple"]}],disabledBinding:[{type:t.HostBinding,args:["attr.disabled"]}],onDrop:[{type:t.HostListener,args:["drop",["$event"]]}],onDragOver:[{type:t.HostListener,args:["dragover",["$event"]]}],onDragEnter:[{type:t.HostListener,args:["dragenter",["$event"]]}],onDragLeave:[{type:t.HostListener,args:["dragleave",["$event"]]}]};var y=function(e){function t(t,n){return e.call(this,t,n)||this}return d(t,e),t}(i.TemplatePortalDirective);y.decorators=[{type:t.Directive,args:[{selector:"[td-file-input-label]ng-template"}]}],y.ctorParameters=function(){return[{type:t.TemplateRef},{type:t.ViewContainerRef}]};var v=function(){return function(e){this._changeDetectorRef=e}}(),b=o.mixinControlValueAccessor(o.mixinDisabled(v)),_=function(e){function r(n,r){var o=e.call(this,r)||this;return o._renderer=n,o._multiple=!1,o.onSelect=new t.EventEmitter,o}return d(r,e),Object.defineProperty(r.prototype,"inputElement",{get:function(){return this._inputElement.nativeElement},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"multiple",{get:function(){return this._multiple},set:function(e){this._multiple=n.coerceBooleanProperty(e)},enumerable:!0,configurable:!0}),r.prototype.handleSelect=function(e){this.writeValue(e),this.onSelect.emit(e)},r.prototype.clear=function(){this.writeValue(undefined),this._renderer.setProperty(this.inputElement,"value","")},r.prototype.onDisabledChange=function(e){e&&this.clear()},r}(b);_.decorators=[{type:t.Component,args:[{changeDetection:t.ChangeDetectionStrategy.OnPush,providers:[{provide:r.NG_VALUE_ACCESSOR,useExisting:t.forwardRef(function(){return _}),multi:!0}],selector:"td-file-input",inputs:["disabled","value"],styles:[":host{ }\n  :host .td-file-input{\n    padding-left:8px;\n    padding-right:8px; }\n  :host input.td-file-input-hidden{\n    display:none; }\n  :host .drop-zone{\n    border-radius:3px; }\n    :host .drop-zone *{\n      pointer-events:none; }\n"],template:'<div>\n  <button mat-raised-button\n          class="td-file-input"\n          type="button"\n          [color]="color"\n          [multiple]="multiple"\n          [disabled]="disabled"\n          (keyup.enter)="fileInput.click()"\n          (click)="fileInput.click()"\n          (fileDrop)="handleSelect($event)"\n          tdFileDrop>\n    <ng-content></ng-content>\n  </button>\n  <input #fileInput\n          class="td-file-input-hidden"\n          type="file"\n          [attr.accept]="accept"\n          (fileSelect)="handleSelect($event)"\n          [multiple]="multiple"\n          [disabled]="disabled"\n          tdFileSelect>\n</div>'}]}],_.ctorParameters=function(){return[{type:t.Renderer2},{type:t.ChangeDetectorRef}]},_.propDecorators={_inputElement:[{type:t.ViewChild,args:["fileInput"]}],color:[{type:t.Input,args:["color"]}],multiple:[{type:t.Input,args:["multiple"]}],accept:[{type:t.Input,args:["accept"]}],onSelect:[{type:t.Output,args:["select"]}]};var C=function(){return function(e){this._changeDetectorRef=e}}(),D=o.mixinControlValueAccessor(o.mixinDisabled(C)),E=function(e){function r(n){var r=e.call(this,n)||this;return r._multiple=!1,r._required=!1,r.defaultColor="primary",r.activeColor="accent",r.cancelColor="warn",r.onSelect=new t.EventEmitter,r.onUpload=new t.EventEmitter,r.onCancel=new t.EventEmitter,r}return d(r,e),Object.defineProperty(r.prototype,"multiple",{get:function(){return this._multiple},set:function(e){this._multiple=n.coerceBooleanProperty(e)},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"required",{get:function(){return this._required},set:function(e){this._required=n.coerceBooleanProperty(e)},enumerable:!0,configurable:!0}),r.prototype.uploadPressed=function(){this.value&&this.onUpload.emit(this.value)},r.prototype.handleSelect=function(e){this.value=e,this.onSelect.emit(e)},r.prototype.cancel=function(){this.value=undefined,this.onCancel.emit(undefined),this.fileInput&&this.fileInput.clear()},r.prototype.onDisabledChange=function(e){e&&this.cancel()},r}(D);E.decorators=[{type:t.Component,args:[{changeDetection:t.ChangeDetectionStrategy.OnPush,providers:[{provide:r.NG_VALUE_ACCESSOR,useExisting:t.forwardRef(function(){return E}),multi:!0}],selector:"td-file-upload",inputs:["disabled","value"],styles:[".td-file-upload{\n  padding-left:8px;\n  padding-right:8px; }\n.td-file-upload-cancel{\n  height:24px;\n  width:24px;\n  position:relative;\n  top:24px;\n  left:-12px; }\n  ::ng-deep [dir='rtl'] .td-file-upload-cancel{\n    right:-12px;\n    left:0; }\n  .td-file-upload-cancel mat-icon{\n    border-radius:12px;\n    vertical-align:baseline; }\n.drop-zone{\n  border-radius:3px; }\n  .drop-zone *{\n    pointer-events:none; }\n"],template:'<td-file-input *ngIf="!value"\n               [(ngModel)]="value"\n               [multiple]="multiple"\n               [disabled]="disabled"\n               [accept]="accept"\n               [color]="defaultColor"\n               (select)="handleSelect($event)">\n  <ng-template [cdkPortalHost]="inputLabel" [ngIf]="true"></ng-template>\n</td-file-input>\n<div *ngIf="value">\n  <button #fileUpload\n          class="td-file-upload"\n          mat-raised-button\n          type="button"\n          [color]="activeColor"\n          (keyup.delete)="cancel()"\n          (keyup.backspace)="cancel()"\n          (keyup.escape)="cancel()"\n          (click)="uploadPressed()">\n    <ng-content></ng-content>\n  </button>\n  <button mat-icon-button\n          type="button"\n          class="td-file-upload-cancel"\n          [color]="cancelColor"\n          (click)="cancel()">\n    <mat-icon>cancel</mat-icon>\n  </button>\n</div>'}]}],E.ctorParameters=function(){return[{type:t.ChangeDetectorRef}]},E.propDecorators={fileInput:[{type:t.ViewChild,args:[_]}],inputLabel:[{type:t.ContentChild,args:[y]}],defaultColor:[{type:t.Input,args:["defaultColor"]}],activeColor:[{type:t.Input,args:["activeColor"]}],cancelColor:[{type:t.Input,args:["cancelColor"]}],multiple:[{type:t.Input,args:["multiple"]}],required:[{type:t.Input,args:["required"]}],accept:[{type:t.Input,args:["accept"]}],onSelect:[{type:t.Output,args:["select"]}],onUpload:[{type:t.Output,args:["upload"]}],onCancel:[{type:t.Output,args:["cancel"]}]};var O=function(){function e(){this._progressSubject=new a.Subject,this._progressObservable=this._progressSubject.asObservable()}return Object.defineProperty(e.prototype,"progress",{get:function(){return this._progressObservable},enumerable:!0,configurable:!0}),e.prototype.upload=function(e){var t=this;return new l.Observable(function(n){var r=new XMLHttpRequest,o=new FormData;if(e.file!==undefined)o.append("file",e.file);else{if(e.formData===undefined)return n.error("For [IUploadOptions] you have to set either the [file] or the [formData] property.");o=e.formData}if(r.upload.onprogress=function(e){var n=0;e.lengthComputable&&(n=Math.round(e.loaded/e.total*100)),t._progressSubject.next(n)},r.onreadystatechange=function(){4===r.readyState&&(r.status>=200&&r.status<300?(n.next(r.response),n.complete()):n.error(r.response))},r.open(e.method,e.url,!0),r.setRequestHeader("X-Requested-With","XMLHttpRequest"),e.headers)for(var i in e.headers)r.setRequestHeader(i,e.headers[i]);r.send(o)})},e}();O.decorators=[{type:t.Injectable}],O.ctorParameters=function(){return[]};var x=[f,h,E,_,y],P=function(){return function(){}}();P.decorators=[{type:t.NgModule,args:[{imports:[r.FormsModule,p.CommonModule,u.MatIconModule,c.MatButtonModule,i.PortalModule],declarations:[x],exports:[x],providers:[O]}]}],P.ctorParameters=function(){return[]},e.CovalentFileModule=P,e.TdFileDropBase=m,e._TdFileDropMixinBase=g,e.TdFileDropDirective=h,e.TdFileSelectDirective=f,e.TdFileInputLabelDirective=y,e.TdFileInputBase=v,e._TdFileInputMixinBase=b,e.TdFileInputComponent=_,e.TdFileUploadBase=C,e._TdFileUploadMixinBase=D,e.TdFileUploadComponent=E,e.TdFileService=O,Object.defineProperty(e,"__esModule",{value:!0})});
//# sourceMappingURL=covalent-core-file.umd.min.js.map
