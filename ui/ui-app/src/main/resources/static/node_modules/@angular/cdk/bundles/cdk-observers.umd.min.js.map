{"version":3,"file":"cdk-observers.umd.min.js","sources":["../../src/cdk/observers/observe-content.ts"],"sourcesContent":["/**\n * @license\n * Copyright Google LLC All Rights Reserved.\n *\n * Use of this source code is governed by an MIT-style license that can be\n * found in the LICENSE file at https://angular.io/license\n */\n\nimport {\n  Directive,\n  ElementRef,\n  NgModule,\n  Output,\n  Input,\n  EventEmitter,\n  OnDestroy,\n  AfterContentInit,\n  Injectable,\n  NgZone,\n} from '@angular/core';\nimport {Subject} from 'rxjs/Subject';\nimport {debounceTime} from 'rxjs/operators/debounceTime';\n\n/**\n * Factory that creates a new MutationObserver and allows us to stub it out in unit tests.\n * @docs-private\n */\n@Injectable()\nexport class MutationObserverFactory {\n  create(callback: MutationCallback): MutationObserver | null {\n    return typeof MutationObserver === 'undefined' ? null : new MutationObserver(callback);\n  }\n}\n\n/**\n * Directive that triggers a callback whenever the content of\n * its associated element has changed.\n */\n@Directive({\n  selector: '[cdkObserveContent]',\n  exportAs: 'cdkObserveContent',\n})\nexport class CdkObserveContent implements AfterContentInit, OnDestroy {\n  private _observer: MutationObserver | null;\n\n  /** Event emitted for each change in the element's content. */\n  @Output('cdkObserveContent') event = new EventEmitter<MutationRecord[]>();\n\n  /** Used for debouncing the emitted values to the observeContent event. */\n  private _debouncer = new Subject<MutationRecord[]>();\n\n  /** Debounce interval for emitting the changes. */\n  @Input() debounce: number;\n\n  constructor(\n    private _mutationObserverFactory: MutationObserverFactory,\n    private _elementRef: ElementRef,\n    private _ngZone: NgZone) { }\n\n  ngAfterContentInit() {\n    if (this.debounce > 0) {\n      this._ngZone.runOutsideAngular(() => {\n        this._debouncer.pipe(debounceTime(this.debounce))\n            .subscribe((mutations: MutationRecord[]) => this.event.emit(mutations));\n      });\n    } else {\n      this._debouncer.subscribe(mutations => this.event.emit(mutations));\n    }\n\n    this._observer = this._ngZone.runOutsideAngular(() => {\n      return this._mutationObserverFactory.create((mutations: MutationRecord[]) => {\n        this._debouncer.next(mutations);\n      });\n    });\n\n    if (this._observer) {\n      this._observer.observe(this._elementRef.nativeElement, {\n        'characterData': true,\n        'childList': true,\n        'subtree': true\n      });\n    }\n  }\n\n  ngOnDestroy() {\n    if (this._observer) {\n      this._observer.disconnect();\n    }\n\n    this._debouncer.complete();\n  }\n}\n\n\n@NgModule({\n  exports: [CdkObserveContent],\n  declarations: [CdkObserveContent],\n  providers: [MutationObserverFactory]\n})\nexport class ObserversModule {}\n"],"names":["MutationObserverFactory","prototype","create","callback","MutationObserver","type","Injectable","CdkObserveContent","_mutationObserverFactory","_elementRef","_ngZone","this","event","EventEmitter","_debouncer","Subject","ngAfterContentInit","_this","debounce","runOutsideAngular","pipe","debounceTime","subscribe","mutations","emit","_observer","next","observe","nativeElement","characterData","childList","subtree","ngOnDestroy","disconnect","complete","Directive","args","selector","exportAs","ElementRef","NgZone","Output","Input","ObserversModule","NgModule","exports","declarations","providers"],"mappings":";;;;;;;qdAAA,MA6BEA,GAAFC,UAAAC,OAAE,SAAOC,GACL,MAAmC,mBAArBC,kBAAmC,KAAO,GAAIA,kBAAiBD,mBAHjFE,KAACC,EAAAA,mDA3BDN,kBAsDE,QAAFO,GACYC,EACAC,EACAC,GAFAC,KAAZH,yBAAYA,EACAG,KAAZF,YAAYA,EACAE,KAAZD,QAAYA,EAXZC,KAAAC,MAAuC,GAAIC,GAAAA,aAG3CF,KAAAG,WAAuB,GAAIC,GAAAA,QAjD3B,MA2DER,GAAFN,UAAAe,mBAAE,WAAA,GAAFC,GAAAN,IACQA,MAAKO,SAAW,EAClBP,KAAKD,QAAQS,kBAAkB,WAC7BF,EAAKH,WAAWM,KAAKC,EAAAA,aAAaJ,EAAKC,WAClCI,UAAU,SAACC,GAAgC,MAAAN,GAAKL,MAAMY,KAAKD,OAGlEZ,KAAKG,WAAWQ,UAAU,SAAAC,GAAa,MAAAN,GAAKL,MAAMY,KAAKD,KAGzDZ,KAAKc,UAAYd,KAAKD,QAAQS,kBAAkB,WAC9C,MAAOF,GAAKT,yBAAyBN,OAAO,SAACqB,GAC3CN,EAAKH,WAAWY,KAAKH,OAIrBZ,KAAKc,WACPd,KAAKc,UAAUE,QAAQhB,KAAKF,YAAYmB,eACtCC,eAAiB,EACjBC,WAAa,EACbC,SAAW,KAKjBxB,EAAFN,UAAA+B,YAAE,WACMrB,KAAKc,WACPd,KAAKc,UAAUQ,aAGjBtB,KAAKG,WAAWoB,2BAnDpB7B,KAAC8B,EAAAA,UAADC,OACEC,SAAU,sBACVC,SAAU,4DAZZjC,KAAaL,IAlBbK,KAAEkC,EAAAA,aAQFlC,KAAEmC,EAAAA,4BA4BF5B,QAAAP,KAAGoC,EAAAA,OAAHL,MAAU,uBAMVlB,WAAAb,KAAGqC,EAAAA,SApDHnC,KA0CAoC,EAAA,yBA1CA,sBA8FAtC,KAACuC,EAAAA,SAADR,OACES,SAAUtC,GACVuC,cAAevC,GACfwC,WAAY/C,6CAjGd2C"}